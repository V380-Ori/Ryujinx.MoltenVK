From c07cc2d690fd3b6a87550edaabec9cf6032dadf1 Mon Sep 17 00:00:00 2001
From: V380-Ori <infiniteloop0finsanity@gmail.com>
Date: Fri, 19 Dec 2025 17:59:01 +0200
Subject: [PATCH] Do not set primitive restart.

Fixes graphical issues in some games.
---
 MoltenVK/MoltenVK/Commands/MVKCommandEncoderState.mm | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/MoltenVK/MoltenVK/Commands/MVKCommandEncoderState.mm b/MoltenVK/MoltenVK/Commands/MVKCommandEncoderState.mm
index a200e9c6..395f75b1 100644
--- a/MoltenVK/MoltenVK/Commands/MVKCommandEncoderState.mm
+++ b/MoltenVK/MoltenVK/Commands/MVKCommandEncoderState.mm
@@ -1338,7 +1338,7 @@ static uint32_t getSampleCount(VkSampleCountFlags vk) {
 			}
 		}
 #endif
-#if MVK_USE_METAL_PRIVATE_API
+#if 0
 		if (anyStateNeeded.has(MVKRenderStateFlag::PrimitiveRestartEnable) && mvkEncoder.getMVKConfig().useMetalPrivateAPI) {
 			bool enable = PICK_STATE(PrimitiveRestartEnable)->enable.has(MVKRenderStateEnableFlag::PrimitiveRestart);
 			uint32_t index = mvkPrimRestartIndexFromVkIndexType(vk._indexBuffer.vkIndexType);
-- 
2.50.1 (Apple Git-155)

